{ const WEATHER_CLEARclear const WEATHER_SNOW weathersfx_weather_snow const WEATHER_RAIN weathersfx_weather_rain const WEATHER_STORMweathersfx_weather_rain_storm const WEATHER_FOG_GREEN weathersfx_weather_snow const WEATHER_FOG_BROWN weathersfx_weather_snow const WEATHER_FOG_RED weathersfx_weather_snow const WEATHER_FOG_WHITE weathersfx_weather_snow const WEATHER_FOG_BLUE weathersfx_weather_snow const WEATHER_FOG_THICK weathersfx_weather_snow const WEATHER_FOG_BLACK weathersfx_weather_snow const WEATHER_STOP_TIME 0 const WEATHER_START_TIME 15 const WEATHER_DUR_MIN1 const WEATHER_DUR_MAX6 setvarg GLOBAL_WEATHER WEATHER_CLEAR callexternal all worldevent_weather clearclientevent update all const.localplayer.scriptID clear_weather}{ worldevent_timelocal l.expiretime global.weather.startadd l.expiretime global.weather.durationlocal l.changeweather 0if( global.mstime.secs >= l.expiretime )local l.changeweather 1if( global.mstime.secs < global.weather.start )local l.changeweather 1if l.changeweatherif ( game.time > 10 ){callevent 45.0 random_map_weather}else{callevent random_map_weather}setvarg global.weather.start global.mstime.secssetvarg global.weather.duration $rand(WEATHER_DUR_MIN,WEATHER_DUR_MAX)multiply global.weather.duration 3600}{ random_map_weatherlocal l.weathertotal $get_token_amt(global.map.weather)subtract l.weathertotal 1local l.weathernum $rand(0,l.weathertotal)local l.weathername $get_token(global.map.weather,l.weathernum)if ( G_DEVELOPER_MODE ){local MSG_LIST l.weathernamestradd MSG_LIST " of "stradd MSG_LIST global.map.weatherinfomsg all "WEATHER SET TO" MSG_LIST}callevent game_playercmd_setweather l.weathername $randf(5,15) $randf(5,15)}{ game_playercmd_setweathercallevent weather_to_scriptname PARAM1setvard WEATHER_TYPE PARAM1if weather.name isnot '0'setvard NEW_WEATHER weather.namesetvard NEW_WEATHER_STOPOLD_DELAYWEATHER_STOP_TIMEsetvard NEW_WEATHER_START_DELAYWEATHER_START_TIMEif( PARAM2 isnot 'default' ) setvard NEW_WEATHER_STOPOLD_DELAY PARAM2if( PARAM3 isnot 'default' ) setvard NEW_WEATHER_START_DELAY PARAM3callexternal all worldevent_weather PARAM1callevent global_change_weather}{ game_playercmd_setweather_mecallevent weather_to_scriptname PARAM1setvard WEATHER_TYPE PARAM1if weather.name isnot '0'setvard NEW_WEATHER weather.namesetvard NEW_WEATHER_STOPOLD_DELAY1setvard NEW_WEATHER_START_DELAY1callexternal PARAM2 worldevent_weather PARAM1callevent global_change_weather}{ game_change_weathersetvard NEW_WEATHER PARAM1setvard NEW_WEATHER_STOPOLD_DELAYPARAM2setvard NEW_WEATHER_START_DELAYPARAM3callexternal all worldevent_weather PARAM1callevent global_change_weather}{ game_precache_weatherprecachefile game.precacheweather}{ global_change_weathercallevent global_stop_weatherlocal STARTWEATHER_DELAY 0if( GLOBAL_WEATHER isnot WEATHER_CLEAR ){setvard STARTWEATHER_DELAY NEW_WEATHER_STOPOLD_DELAY}else{clientevent update all const.localplayer.scriptID clear_weather}if( NEW_WEATHER isnot WEATHER_CLEAR ) callevent STARTWEATHER_DELAY global_start_weather}{ global_stop_weatherif GLOBAL_WEATHER isnot 'GLOBAL_WEATHER'if GLOBAL_WEATHER isnot WEATHER_CLEARif game.players > 0callexternal ent_me worldevent_weather_die NEW_WEATHER_STOPOLD_DELAY}{ global_start_weatherif NEW_WEATHER isnot 'NEW_WEATHER'setvarg GLOBAL_WEATHER NEW_WEATHERif NEW_WEATHER isnot WEATHER_CLEARif game.players > 0setvarg G_CUR_WEATHER GLOBAL_WEATHERdbg global_start_weather $get(ent_me,name)applyeffect ent_me GLOBAL_WEATHER NEW_WEATHER_START_DELAY WEATHER_TYPE}{game_precachecallevent map_setweathercalleventloop $get_token_amt(global.map.weather) weather_precache_mapweather}{weather_precache_mapweatherlocal l.weathername $get_token(global.map.weather,game.script.iteration)callevent weather_to_scriptname l.weathernameif weather.name isnot WEATHER_CLEARif weather.name isnot '0'precachefile weather.name}{weather_to_scriptnameif( PARAM1 equals 'clear' )setvard weather.name WEATHER_CLEAR else if( PARAM1 equals 'snow' )setvard weather.name WEATHER_SNOWelse if( PARAM1 equals 'rain' )setvard weather.name WEATHER_RAINelse if( PARAM1 equals 'storm' )setvard weather.name WEATHER_STORMelse if( PARAM1 equals 'fog_green' ) setvard weather.name WEATHER_FOG_GREENelse if( PARAM1 equals 'fog_brown' ) setvard weather.name WEATHER_FOG_BROWNelse if( PARAM1 equals 'fog_red' ) setvard weather.name WEATHER_FOG_REDelse if( PARAM1 equals 'fog_white' ) setvard weather.name WEATHER_FOG_WHITEelse if( PARAM1 equals 'fog_blue' ) setvard weather.name WEATHER_FOG_BLUEelse if( PARAM1 equals 'fog_thick' ) setvard weather.name WEATHER_FOG_THICKelse if( PARAM1 equals 'fog_black' ) setvard weather.name WEATHER_FOG_BLACKelse setvard weather.name 0setvarg G_WEATHER_SCRIPT weather.nameif ( PARAM1 equals 'clear' ) clientevent update all const.localplayer.scriptID clear_weather}